     1 00000000                                 [FORMAT "WCOFF"]
     2 00000000                                 [INSTRSET "i486p"]
     3 00000000                                 [OPTIMIZE 1]
     4 00000000                                 [OPTION 1]
     5 00000000                                 [BITS 32]
     6 00000000                                 	EXTERN	_memman_alloc_4k
     7 00000000                                 	EXTERN	_memman_free
     8 00000000                                 	EXTERN	_min
     9 00000000                                 	EXTERN	_max
    10 00000000                                 [FILE "sheet.c"]
    11                                          [SECTION .text]
    12 00000000                                 	GLOBAL	_sheetctrl_init
    13 00000000                                 _sheetctrl_init:
    14 00000000 55                              	PUSH	EBP
    15 00000001 89 E5                           	MOV	EBP,ESP
    16 00000003 57                              	PUSH	EDI
    17 00000004 56                              	PUSH	ESI
    18 00000005 53                              	PUSH	EBX
    19 00000006 8B 75 08                        	MOV	ESI,DWORD [8+EBP]
    20 00000009 68 00002814                     	PUSH	10260
    21 0000000E 8B 7D 10                        	MOV	EDI,DWORD [16+EBP]
    22 00000011 56                              	PUSH	ESI
    23 00000012 E8 [00000000]                   	CALL	_memman_alloc_4k
    24 00000017 89 C3                           	MOV	EBX,EAX
    25 00000019 58                              	POP	EAX
    26 0000001A 5A                              	POP	EDX
    27 0000001B 85 DB                           	TEST	EBX,EBX
    28 0000001D 74 4A                           	JE	L3
    29 0000001F 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    30 00000022 0F AF C7                        	IMUL	EAX,EDI
    31 00000025 50                              	PUSH	EAX
    32 00000026 56                              	PUSH	ESI
    33 00000027 E8 [00000000]                   	CALL	_memman_alloc_4k
    34 0000002C 85 C0                           	TEST	EAX,EAX
    35 0000002E 89 43 04                        	MOV	DWORD [4+EBX],EAX
    36 00000031 5A                              	POP	EDX
    37 00000032 59                              	POP	ECX
    38 00000033 74 3E                           	JE	L11
    39 00000035 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    40 00000038 89 7B 08                        	MOV	DWORD [8+EBX],EDI
    41 0000003B 89 03                           	MOV	DWORD [EBX],EAX
    42 0000003D 8D 93 000023DC                  	LEA	EDX,DWORD [9180+EBX]
    43 00000043 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
    44 00000046 89 43 0C                        	MOV	DWORD [12+EBX],EAX
    45 00000049 89 D8                           	MOV	EAX,EBX
    46 0000004B C7 43 10 FFFFFFFF               	MOV	DWORD [16+EBX],-1
    47 00000052                                 L9:
    48 00000052 C7 80 00000430 00000000         	MOV	DWORD [1072+EAX],0
    49 0000005C 89 98 00000434                  	MOV	DWORD [1076+EAX],EBX
    50 00000062 83 C0 24                        	ADD	EAX,36
    51 00000065 39 D0                           	CMP	EAX,EDX
    52 00000067 7E E9                           	JLE	L9
    53 00000069                                 L3:
    54 00000069 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
    55 0000006C 89 D8                           	MOV	EAX,EBX
    56 0000006E 5B                              	POP	EBX
    57 0000006F 5E                              	POP	ESI
    58 00000070 5F                              	POP	EDI
    59 00000071 5D                              	POP	EBP
    60 00000072 C3                              	RET
    61 00000073                                 L11:
    62 00000073 68 00002814                     	PUSH	10260
    63 00000078 53                              	PUSH	EBX
    64 00000079 56                              	PUSH	ESI
    65 0000007A E8 [00000000]                   	CALL	_memman_free
    66 0000007F 83 C4 0C                        	ADD	ESP,12
    67 00000082 EB E5                           	JMP	L3
    68 00000084                                 	GLOBAL	_sheet_alloc
    69 00000084                                 _sheet_alloc:
    70 00000084 55                              	PUSH	EBP
    71 00000085 31 D2                           	XOR	EDX,EDX
    72 00000087 89 E5                           	MOV	EBP,ESP
    73 00000089 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
    74 0000008C 05 00000414                     	ADD	EAX,1044
    75 00000091                                 L18:
    76 00000091 83 78 1C 00                     	CMP	DWORD [28+EAX],0
    77 00000095 74 10                           	JE	L21
    78 00000097 42                              	INC	EDX
    79 00000098 83 C0 24                        	ADD	EAX,36
    80 0000009B 81 FA 000000FF                  	CMP	EDX,255
    81 000000A1 7E EE                           	JLE	L18
    82 000000A3 31 C0                           	XOR	EAX,EAX
    83 000000A5                                 L12:
    84 000000A5 5D                              	POP	EBP
    85 000000A6 C3                              	RET
    86 000000A7                                 L21:
    87 000000A7 C7 40 1C 00000001               	MOV	DWORD [28+EAX],1
    88 000000AE C7 40 18 FFFFFFFF               	MOV	DWORD [24+EAX],-1
    89 000000B5 EB EE                           	JMP	L12
    90 000000B7                                 	GLOBAL	_sheet_setbuf
    91 000000B7                                 _sheet_setbuf:
    92 000000B7 55                              	PUSH	EBP
    93 000000B8 89 E5                           	MOV	EBP,ESP
    94 000000BA 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
    95 000000BD 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
    96 000000C0 89 02                           	MOV	DWORD [EDX],EAX
    97 000000C2 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
    98 000000C5 89 42 04                        	MOV	DWORD [4+EDX],EAX
    99 000000C8 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   100 000000CB 89 42 08                        	MOV	DWORD [8+EDX],EAX
   101 000000CE 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   102 000000D1 89 42 14                        	MOV	DWORD [20+EDX],EAX
   103 000000D4 5D                              	POP	EBP
   104 000000D5 C3                              	RET
   105 000000D6                                 	GLOBAL	_sheet_updown
   106 000000D6                                 _sheet_updown:
   107 000000D6 55                              	PUSH	EBP
   108 000000D7 89 E5                           	MOV	EBP,ESP
   109 000000D9 57                              	PUSH	EDI
   110 000000DA 56                              	PUSH	ESI
   111 000000DB 53                              	PUSH	EBX
   112 000000DC 51                              	PUSH	ECX
   113 000000DD 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   114 000000E0 8B 77 20                        	MOV	ESI,DWORD [32+EDI]
   115 000000E3 8B 47 18                        	MOV	EAX,DWORD [24+EDI]
   116 000000E6 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   117 000000E9 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   118 000000EC 40                              	INC	EAX
   119 000000ED 50                              	PUSH	EAX
   120 000000EE FF 75 0C                        	PUSH	DWORD [12+EBP]
   121 000000F1 E8 [00000000]                   	CALL	_min
   122 000000F6 6A FF                           	PUSH	-1
   123 000000F8 50                              	PUSH	EAX
   124 000000F9 E8 [00000000]                   	CALL	_max
   125 000000FE 83 C4 10                        	ADD	ESP,16
   126 00000101 89 C3                           	MOV	EBX,EAX
   127 00000103 89 47 18                        	MOV	DWORD [24+EDI],EAX
   128 00000106 39 45 F0                        	CMP	DWORD [-16+EBP],EAX
   129 00000109 0F 8E 000000AF                  	JLE	L24
   130 0000010F 85 C0                           	TEST	EAX,EAX
   131 00000111 78 5C                           	JS	L25
   132 00000113 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   133 00000116                                 L30:
   134 00000116 8B 44 8E 10                     	MOV	EAX,DWORD [16+ESI+ECX*4]
   135 0000011A 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   136 0000011E 89 48 18                        	MOV	DWORD [24+EAX],ECX
   137 00000121 49                              	DEC	ECX
   138 00000122 39 D9                           	CMP	ECX,EBX
   139 00000124 7F F0                           	JG	L30
   140 00000126 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   141 0000012A 43                              	INC	EBX
   142 0000012B 53                              	PUSH	EBX
   143 0000012C 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   144 0000012F 89 C8                           	MOV	EAX,ECX
   145 00000131 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   146 00000134 50                              	PUSH	EAX
   147 00000135 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   148 00000138 89 D0                           	MOV	EAX,EDX
   149 0000013A 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   150 0000013D 50                              	PUSH	EAX
   151 0000013E 51                              	PUSH	ECX
   152 0000013F 52                              	PUSH	EDX
   153 00000140 56                              	PUSH	ESI
   154 00000141 E8 0000032F                     	CALL	_sheet_refreshmap
   155 00000146 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   156 00000149                                 L60:
   157 00000149 53                              	PUSH	EBX
   158 0000014A                                 L59:
   159 0000014A 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   160 0000014D 89 C8                           	MOV	EAX,ECX
   161 0000014F 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   162 00000152 50                              	PUSH	EAX
   163 00000153 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   164 00000156 89 D0                           	MOV	EAX,EDX
   165 00000158 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   166 0000015B 50                              	PUSH	EAX
   167 0000015C 51                              	PUSH	ECX
   168 0000015D 52                              	PUSH	EDX
   169 0000015E 56                              	PUSH	ESI
   170 0000015F E8 000001CD                     	CALL	_sheet_refreshsub
   171 00000164 83 C4 34                        	ADD	ESP,52
   172 00000167                                 L23:
   173 00000167 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   174 0000016A 5B                              	POP	EBX
   175 0000016B 5E                              	POP	ESI
   176 0000016C 5F                              	POP	EDI
   177 0000016D 5D                              	POP	EBP
   178 0000016E C3                              	RET
   179 0000016F                                 L25:
   180 0000016F 8B 46 10                        	MOV	EAX,DWORD [16+ESI]
   181 00000172 3B 45 F0                        	CMP	EAX,DWORD [-16+EBP]
   182 00000175 7E 18                           	JLE	L32
   183 00000177 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   184 0000017A 39 C1                           	CMP	ECX,EAX
   185 0000017C 7D 11                           	JGE	L32
   186 0000017E                                 L37:
   187 0000017E 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   188 00000182 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   189 00000186 89 48 18                        	MOV	DWORD [24+EAX],ECX
   190 00000189 41                              	INC	ECX
   191 0000018A 3B 4E 10                        	CMP	ECX,DWORD [16+ESI]
   192 0000018D 7C EF                           	JL	L37
   193 0000018F                                 L32:
   194 0000018F FF 4E 10                        	DEC	DWORD [16+ESI]
   195 00000192 C7 47 18 FFFFFFFF               	MOV	DWORD [24+EDI],-1
   196 00000199 6A 00                           	PUSH	0
   197 0000019B 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   198 0000019E 89 C8                           	MOV	EAX,ECX
   199 000001A0 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   200 000001A3 50                              	PUSH	EAX
   201 000001A4 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   202 000001A7 89 D0                           	MOV	EAX,EDX
   203 000001A9 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   204 000001AC 50                              	PUSH	EAX
   205 000001AD 51                              	PUSH	ECX
   206 000001AE 52                              	PUSH	EDX
   207 000001AF 56                              	PUSH	ESI
   208 000001B0 E8 000002C0                     	CALL	_sheet_refreshmap
   209 000001B5 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   210 000001B8 48                              	DEC	EAX
   211 000001B9 50                              	PUSH	EAX
   212 000001BA 6A 00                           	PUSH	0
   213 000001BC EB 8C                           	JMP	L59
   214 000001BE                                 L24:
   215 000001BE 39 45 F0                        	CMP	DWORD [-16+EBP],EAX
   216 000001C1 7D A4                           	JGE	L23
   217 000001C3 83 7D F0 00                     	CMP	DWORD [-16+EBP],0
   218 000001C7 78 3C                           	JS	L40
   219 000001C9 8B 4D F0                        	MOV	ECX,DWORD [-16+EBP]
   220 000001CC 39 C1                           	CMP	ECX,EAX
   221 000001CE 7D 10                           	JGE	L56
   222 000001D0                                 L45:
   223 000001D0 8B 44 8E 18                     	MOV	EAX,DWORD [24+ESI+ECX*4]
   224 000001D4 89 44 8E 14                     	MOV	DWORD [20+ESI+ECX*4],EAX
   225 000001D8 89 48 18                        	MOV	DWORD [24+EAX],ECX
   226 000001DB 41                              	INC	ECX
   227 000001DC 39 D9                           	CMP	ECX,EBX
   228 000001DE 7C F0                           	JL	L45
   229 000001E0                                 L56:
   230 000001E0 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   231 000001E4                                 L46:
   232 000001E4 53                              	PUSH	EBX
   233 000001E5 8B 4F 10                        	MOV	ECX,DWORD [16+EDI]
   234 000001E8 89 C8                           	MOV	EAX,ECX
   235 000001EA 03 47 08                        	ADD	EAX,DWORD [8+EDI]
   236 000001ED 50                              	PUSH	EAX
   237 000001EE 8B 57 0C                        	MOV	EDX,DWORD [12+EDI]
   238 000001F1 89 D0                           	MOV	EAX,EDX
   239 000001F3 03 47 04                        	ADD	EAX,DWORD [4+EDI]
   240 000001F6 50                              	PUSH	EAX
   241 000001F7 51                              	PUSH	ECX
   242 000001F8 52                              	PUSH	EDX
   243 000001F9 56                              	PUSH	ESI
   244 000001FA E8 00000276                     	CALL	_sheet_refreshmap
   245 000001FF 53                              	PUSH	EBX
   246 00000200 E9 FFFFFF44                     	JMP	L60
   247 00000205                                 L40:
   248 00000205 8B 4E 10                        	MOV	ECX,DWORD [16+ESI]
   249 00000208 39 C1                           	CMP	ECX,EAX
   250 0000020A 7E 13                           	JLE	L58
   251 0000020C                                 L51:
   252 0000020C 8B 54 8E 14                     	MOV	EDX,DWORD [20+ESI+ECX*4]
   253 00000210 8D 41 01                        	LEA	EAX,DWORD [1+ECX]
   254 00000213 89 54 8E 18                     	MOV	DWORD [24+ESI+ECX*4],EDX
   255 00000217 49                              	DEC	ECX
   256 00000218 89 42 18                        	MOV	DWORD [24+EDX],EAX
   257 0000021B 39 D9                           	CMP	ECX,EBX
   258 0000021D 7F ED                           	JG	L51
   259 0000021F                                 L58:
   260 0000021F 89 7C 9E 14                     	MOV	DWORD [20+ESI+EBX*4],EDI
   261 00000223 FF 46 10                        	INC	DWORD [16+ESI]
   262 00000226 EB BC                           	JMP	L46
   263 00000228                                 	GLOBAL	_sheet_refresh
   264 00000228                                 _sheet_refresh:
   265 00000228 55                              	PUSH	EBP
   266 00000229 89 E5                           	MOV	EBP,ESP
   267 0000022B 53                              	PUSH	EBX
   268 0000022C 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   269 0000022F 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   270 00000232 85 C0                           	TEST	EAX,EAX
   271 00000234 78 27                           	JS	L61
   272 00000236 50                              	PUSH	EAX
   273 00000237 50                              	PUSH	EAX
   274 00000238 8B 4B 10                        	MOV	ECX,DWORD [16+EBX]
   275 0000023B 89 C8                           	MOV	EAX,ECX
   276 0000023D 03 4D 10                        	ADD	ECX,DWORD [16+EBP]
   277 00000240 03 45 18                        	ADD	EAX,DWORD [24+EBP]
   278 00000243 50                              	PUSH	EAX
   279 00000244 8B 53 0C                        	MOV	EDX,DWORD [12+EBX]
   280 00000247 89 D0                           	MOV	EAX,EDX
   281 00000249 03 55 0C                        	ADD	EDX,DWORD [12+EBP]
   282 0000024C 03 45 14                        	ADD	EAX,DWORD [20+EBP]
   283 0000024F 50                              	PUSH	EAX
   284 00000250 51                              	PUSH	ECX
   285 00000251 52                              	PUSH	EDX
   286 00000252 FF 73 20                        	PUSH	DWORD [32+EBX]
   287 00000255 E8 000000D7                     	CALL	_sheet_refreshsub
   288 0000025A 83 C4 1C                        	ADD	ESP,28
   289 0000025D                                 L61:
   290 0000025D 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   291 00000260 C9                              	LEAVE
   292 00000261 C3                              	RET
   293 00000262                                 	GLOBAL	_sheet_slide
   294 00000262                                 _sheet_slide:
   295 00000262 55                              	PUSH	EBP
   296 00000263 89 E5                           	MOV	EBP,ESP
   297 00000265 57                              	PUSH	EDI
   298 00000266 56                              	PUSH	ESI
   299 00000267 53                              	PUSH	EBX
   300 00000268 53                              	PUSH	EBX
   301 00000269 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   302 0000026C 8B 43 20                        	MOV	EAX,DWORD [32+EBX]
   303 0000026F 8B 7B 0C                        	MOV	EDI,DWORD [12+EBX]
   304 00000272 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   305 00000275 8B 73 10                        	MOV	ESI,DWORD [16+EBX]
   306 00000278 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   307 0000027B 89 43 0C                        	MOV	DWORD [12+EBX],EAX
   308 0000027E 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   309 00000281 89 43 10                        	MOV	DWORD [16+EBX],EAX
   310 00000284 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   311 00000288 78 7C                           	JS	L63
   312 0000028A 6A 00                           	PUSH	0
   313 0000028C 89 F0                           	MOV	EAX,ESI
   314 0000028E 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   315 00000291 50                              	PUSH	EAX
   316 00000292 89 F8                           	MOV	EAX,EDI
   317 00000294 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   318 00000297 50                              	PUSH	EAX
   319 00000298 56                              	PUSH	ESI
   320 00000299 57                              	PUSH	EDI
   321 0000029A FF 75 F0                        	PUSH	DWORD [-16+EBP]
   322 0000029D E8 000001D3                     	CALL	_sheet_refreshmap
   323 000002A2 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   324 000002A5 FF 73 18                        	PUSH	DWORD [24+EBX]
   325 000002A8 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   326 000002AB 50                              	PUSH	EAX
   327 000002AC 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   328 000002AF 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   329 000002B2 50                              	PUSH	EAX
   330 000002B3 FF 75 10                        	PUSH	DWORD [16+EBP]
   331 000002B6 FF 75 0C                        	PUSH	DWORD [12+EBP]
   332 000002B9 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   333 000002BC E8 000001B4                     	CALL	_sheet_refreshmap
   334 000002C1 8B 43 18                        	MOV	EAX,DWORD [24+EBX]
   335 000002C4 83 C4 30                        	ADD	ESP,48
   336 000002C7 48                              	DEC	EAX
   337 000002C8 50                              	PUSH	EAX
   338 000002C9 89 F0                           	MOV	EAX,ESI
   339 000002CB 6A 00                           	PUSH	0
   340 000002CD 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   341 000002D0 50                              	PUSH	EAX
   342 000002D1 89 F8                           	MOV	EAX,EDI
   343 000002D3 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   344 000002D6 50                              	PUSH	EAX
   345 000002D7 56                              	PUSH	ESI
   346 000002D8 57                              	PUSH	EDI
   347 000002D9 FF 75 F0                        	PUSH	DWORD [-16+EBP]
   348 000002DC E8 00000050                     	CALL	_sheet_refreshsub
   349 000002E1 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   350 000002E4 FF 73 18                        	PUSH	DWORD [24+EBX]
   351 000002E7 FF 73 18                        	PUSH	DWORD [24+EBX]
   352 000002EA 03 43 08                        	ADD	EAX,DWORD [8+EBX]
   353 000002ED 50                              	PUSH	EAX
   354 000002EE 8B 45 0C                        	MOV	EAX,DWORD [12+EBP]
   355 000002F1 03 43 04                        	ADD	EAX,DWORD [4+EBX]
   356 000002F4 50                              	PUSH	EAX
   357 000002F5 FF 75 10                        	PUSH	DWORD [16+EBP]
   358 000002F8 FF 75 0C                        	PUSH	DWORD [12+EBP]
   359 000002FB FF 75 F0                        	PUSH	DWORD [-16+EBP]
   360 000002FE E8 0000002E                     	CALL	_sheet_refreshsub
   361 00000303 83 C4 38                        	ADD	ESP,56
   362 00000306                                 L63:
   363 00000306 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   364 00000309 5B                              	POP	EBX
   365 0000030A 5E                              	POP	ESI
   366 0000030B 5F                              	POP	EDI
   367 0000030C 5D                              	POP	EBP
   368 0000030D C3                              	RET
   369 0000030E                                 	GLOBAL	_sheet_free
   370 0000030E                                 _sheet_free:
   371 0000030E 55                              	PUSH	EBP
   372 0000030F 89 E5                           	MOV	EBP,ESP
   373 00000311 53                              	PUSH	EBX
   374 00000312 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   375 00000315 83 7B 18 00                     	CMP	DWORD [24+EBX],0
   376 00000319 78 0A                           	JS	L66
   377 0000031B 6A FF                           	PUSH	-1
   378 0000031D 53                              	PUSH	EBX
   379 0000031E E8 FFFFFDB3                     	CALL	_sheet_updown
   380 00000323 58                              	POP	EAX
   381 00000324 5A                              	POP	EDX
   382 00000325                                 L66:
   383 00000325 C7 43 1C 00000000               	MOV	DWORD [28+EBX],0
   384 0000032C 8B 5D FC                        	MOV	EBX,DWORD [-4+EBP]
   385 0000032F C9                              	LEAVE
   386 00000330 C3                              	RET
   387 00000331                                 	GLOBAL	_sheet_refreshsub
   388 00000331                                 _sheet_refreshsub:
   389 00000331 55                              	PUSH	EBP
   390 00000332 89 E5                           	MOV	EBP,ESP
   391 00000334 57                              	PUSH	EDI
   392 00000335 56                              	PUSH	ESI
   393 00000336 53                              	PUSH	EBX
   394 00000337 83 EC 30                        	SUB	ESP,48
   395 0000033A 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   396 0000033D 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   397 00000340 8B 00                           	MOV	EAX,DWORD [EAX]
   398 00000342 8B 52 04                        	MOV	EDX,DWORD [4+EDX]
   399 00000345 FF 75 0C                        	PUSH	DWORD [12+EBP]
   400 00000348 6A 00                           	PUSH	0
   401 0000034A 89 55 D4                        	MOV	DWORD [-44+EBP],EDX
   402 0000034D 89 45 D8                        	MOV	DWORD [-40+EBP],EAX
   403 00000350 E8 [00000000]                   	CALL	_max
   404 00000355 FF 75 10                        	PUSH	DWORD [16+EBP]
   405 00000358 6A 00                           	PUSH	0
   406 0000035A 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   407 0000035D E8 [00000000]                   	CALL	_max
   408 00000362 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   409 00000365 FF 75 14                        	PUSH	DWORD [20+EBP]
   410 00000368 FF 77 08                        	PUSH	DWORD [8+EDI]
   411 0000036B 89 45 10                        	MOV	DWORD [16+EBP],EAX
   412 0000036E E8 [00000000]                   	CALL	_min
   413 00000373 FF 75 18                        	PUSH	DWORD [24+EBP]
   414 00000376 FF 77 0C                        	PUSH	DWORD [12+EDI]
   415 00000379 89 45 14                        	MOV	DWORD [20+EBP],EAX
   416 0000037C E8 [00000000]                   	CALL	_min
   417 00000381 8B 55 20                        	MOV	EDX,DWORD [32+EBP]
   418 00000384 83 C4 20                        	ADD	ESP,32
   419 00000387 89 45 18                        	MOV	DWORD [24+EBP],EAX
   420 0000038A 8B 45 1C                        	MOV	EAX,DWORD [28+EBP]
   421 0000038D 89 45 C4                        	MOV	DWORD [-60+EBP],EAX
   422 00000390 39 D0                           	CMP	EAX,EDX
   423 00000392 7E 08                           	JLE	L83
   424 00000394                                 L85:
   425 00000394 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   426 00000397 5B                              	POP	EBX
   427 00000398 5E                              	POP	ESI
   428 00000399 5F                              	POP	EDI
   429 0000039A 5D                              	POP	EBP
   430 0000039B C3                              	RET
   431 0000039C                                 L83:
   432 0000039C 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   433 0000039F 8B 7D C4                        	MOV	EDI,DWORD [-60+EBP]
   434 000003A2 8B 74 B8 14                     	MOV	ESI,DWORD [20+EAX+EDI*4]
   435 000003A6 89 F0                           	MOV	EAX,ESI
   436 000003A8 2B 45 08                        	SUB	EAX,DWORD [8+EBP]
   437 000003AB 8B 16                           	MOV	EDX,DWORD [ESI]
   438 000003AD 89 55 DC                        	MOV	DWORD [-36+EBP],EDX
   439 000003B0 2D 00000414                     	SUB	EAX,1044
   440 000003B5 C1 F8 02                        	SAR	EAX,2
   441 000003B8 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   442 000003BE 88 45 D3                        	MOV	BYTE [-45+EBP],AL
   443 000003C1 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   444 000003C4 2B 46 0C                        	SUB	EAX,DWORD [12+ESI]
   445 000003C7 50                              	PUSH	EAX
   446 000003C8 6A 00                           	PUSH	0
   447 000003CA E8 [00000000]                   	CALL	_max
   448 000003CF 89 45 EC                        	MOV	DWORD [-20+EBP],EAX
   449 000003D2 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   450 000003D5 2B 46 10                        	SUB	EAX,DWORD [16+ESI]
   451 000003D8 50                              	PUSH	EAX
   452 000003D9 6A 00                           	PUSH	0
   453 000003DB E8 [00000000]                   	CALL	_max
   454 000003E0 89 C3                           	MOV	EBX,EAX
   455 000003E2 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   456 000003E5 2B 46 0C                        	SUB	EAX,DWORD [12+ESI]
   457 000003E8 50                              	PUSH	EAX
   458 000003E9 FF 76 04                        	PUSH	DWORD [4+ESI]
   459 000003EC E8 [00000000]                   	CALL	_min
   460 000003F1 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   461 000003F4 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   462 000003F7 2B 46 10                        	SUB	EAX,DWORD [16+ESI]
   463 000003FA 50                              	PUSH	EAX
   464 000003FB FF 76 08                        	PUSH	DWORD [8+ESI]
   465 000003FE E8 [00000000]                   	CALL	_min
   466 00000403 83 C4 20                        	ADD	ESP,32
   467 00000406 39 C3                           	CMP	EBX,EAX
   468 00000408 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   469 0000040B 7D 3B                           	JGE	L87
   470 0000040D                                 L82:
   471 0000040D 8B 7E 10                        	MOV	EDI,DWORD [16+ESI]
   472 00000410 8B 4D EC                        	MOV	ECX,DWORD [-20+EBP]
   473 00000413 01 DF                           	ADD	EDI,EBX
   474 00000415 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   475 00000418 89 7D E0                        	MOV	DWORD [-32+EBP],EDI
   476 0000041B 7D 25                           	JGE	L89
   477 0000041D                                 L81:
   478 0000041D 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   479 00000420 8B 7D E0                        	MOV	EDI,DWORD [-32+EBP]
   480 00000423 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   481 00000426 0F AF 7A 08                     	IMUL	EDI,DWORD [8+EDX]
   482 0000042A 01 C8                           	ADD	EAX,ECX
   483 0000042C 8A 55 D3                        	MOV	DL,BYTE [-45+EBP]
   484 0000042F 01 F8                           	ADD	EAX,EDI
   485 00000431 8B 7D D4                        	MOV	EDI,DWORD [-44+EBP]
   486 00000434 89 45 C8                        	MOV	DWORD [-56+EBP],EAX
   487 00000437 38 14 38                        	CMP	BYTE [EAX+EDI*1],DL
   488 0000043A 74 20                           	JE	L90
   489 0000043C                                 L78:
   490 0000043C 41                              	INC	ECX
   491 0000043D 3B 4D E8                        	CMP	ECX,DWORD [-24+EBP]
   492 00000440 7C DB                           	JL	L81
   493 00000442                                 L89:
   494 00000442 43                              	INC	EBX
   495 00000443 3B 5D E4                        	CMP	EBX,DWORD [-28+EBP]
   496 00000446 7C C5                           	JL	L82
   497 00000448                                 L87:
   498 00000448 8B 7D 20                        	MOV	EDI,DWORD [32+EBP]
   499 0000044B FF 45 C4                        	INC	DWORD [-60+EBP]
   500 0000044E 39 7D C4                        	CMP	DWORD [-60+EBP],EDI
   501 00000451 0F 8E FFFFFF45                  	JLE	L83
   502 00000457 E9 FFFFFF38                     	JMP	L85
   503 0000045C                                 L90:
   504 0000045C 89 D8                           	MOV	EAX,EBX
   505 0000045E 8B 55 DC                        	MOV	EDX,DWORD [-36+EBP]
   506 00000461 0F AF 46 04                     	IMUL	EAX,DWORD [4+ESI]
   507 00000465 01 C8                           	ADD	EAX,ECX
   508 00000467 8B 7D D8                        	MOV	EDI,DWORD [-40+EBP]
   509 0000046A 8A 04 10                        	MOV	AL,BYTE [EAX+EDX*1]
   510 0000046D 8B 55 C8                        	MOV	EDX,DWORD [-56+EBP]
   511 00000470 88 04 3A                        	MOV	BYTE [EDX+EDI*1],AL
   512 00000473 EB C7                           	JMP	L78
   513 00000475                                 	GLOBAL	_sheet_refreshmap
   514 00000475                                 _sheet_refreshmap:
   515 00000475 55                              	PUSH	EBP
   516 00000476 89 E5                           	MOV	EBP,ESP
   517 00000478 57                              	PUSH	EDI
   518 00000479 56                              	PUSH	ESI
   519 0000047A 53                              	PUSH	EBX
   520 0000047B 83 EC 2C                        	SUB	ESP,44
   521 0000047E 8B 45 08                        	MOV	EAX,DWORD [8+EBP]
   522 00000481 8B 40 04                        	MOV	EAX,DWORD [4+EAX]
   523 00000484 FF 75 0C                        	PUSH	DWORD [12+EBP]
   524 00000487 6A 00                           	PUSH	0
   525 00000489 89 45 D4                        	MOV	DWORD [-44+EBP],EAX
   526 0000048C E8 [00000000]                   	CALL	_max
   527 00000491 FF 75 10                        	PUSH	DWORD [16+EBP]
   528 00000494 6A 00                           	PUSH	0
   529 00000496 89 45 F0                        	MOV	DWORD [-16+EBP],EAX
   530 00000499 E8 [00000000]                   	CALL	_max
   531 0000049E 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   532 000004A1 FF 75 14                        	PUSH	DWORD [20+EBP]
   533 000004A4 FF 72 08                        	PUSH	DWORD [8+EDX]
   534 000004A7 89 45 10                        	MOV	DWORD [16+EBP],EAX
   535 000004AA E8 [00000000]                   	CALL	_min
   536 000004AF 8B 5D 08                        	MOV	EBX,DWORD [8+EBP]
   537 000004B2 FF 75 18                        	PUSH	DWORD [24+EBP]
   538 000004B5 FF 73 0C                        	PUSH	DWORD [12+EBX]
   539 000004B8 89 45 14                        	MOV	DWORD [20+EBP],EAX
   540 000004BB E8 [00000000]                   	CALL	_min
   541 000004C0 8B 7D 1C                        	MOV	EDI,DWORD [28+EBP]
   542 000004C3 83 C4 20                        	ADD	ESP,32
   543 000004C6 89 45 18                        	MOV	DWORD [24+EBP],EAX
   544 000004C9 89 7D C8                        	MOV	DWORD [-56+EBP],EDI
   545 000004CC 3B 7B 10                        	CMP	EDI,DWORD [16+EBX]
   546 000004CF 7E 08                           	JLE	L107
   547 000004D1                                 L109:
   548 000004D1 8D 65 F4                        	LEA	ESP,DWORD [-12+EBP]
   549 000004D4 5B                              	POP	EBX
   550 000004D5 5E                              	POP	ESI
   551 000004D6 5F                              	POP	EDI
   552 000004D7 5D                              	POP	EBP
   553 000004D8 C3                              	RET
   554 000004D9                                 L107:
   555 000004D9 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   556 000004DC 8B 45 C8                        	MOV	EAX,DWORD [-56+EBP]
   557 000004DF 8B 74 82 14                     	MOV	ESI,DWORD [20+EDX+EAX*4]
   558 000004E3 89 F0                           	MOV	EAX,ESI
   559 000004E5 29 D0                           	SUB	EAX,EDX
   560 000004E7 8B 1E                           	MOV	EBX,DWORD [ESI]
   561 000004E9 2D 00000414                     	SUB	EAX,1044
   562 000004EE 89 5D DC                        	MOV	DWORD [-36+EBP],EBX
   563 000004F1 C1 F8 02                        	SAR	EAX,2
   564 000004F4 69 C0 38E38E39                  	IMUL	EAX,EAX,954437177
   565 000004FA 88 45 DB                        	MOV	BYTE [-37+EBP],AL
   566 000004FD 8B 45 F0                        	MOV	EAX,DWORD [-16+EBP]
   567 00000500 2B 46 0C                        	SUB	EAX,DWORD [12+ESI]
   568 00000503 50                              	PUSH	EAX
   569 00000504 6A 00                           	PUSH	0
   570 00000506 E8 [00000000]                   	CALL	_max
   571 0000050B 89 45 E8                        	MOV	DWORD [-24+EBP],EAX
   572 0000050E 8B 45 10                        	MOV	EAX,DWORD [16+EBP]
   573 00000511 2B 46 10                        	SUB	EAX,DWORD [16+ESI]
   574 00000514 50                              	PUSH	EAX
   575 00000515 6A 00                           	PUSH	0
   576 00000517 E8 [00000000]                   	CALL	_max
   577 0000051C 89 C3                           	MOV	EBX,EAX
   578 0000051E 8B 45 14                        	MOV	EAX,DWORD [20+EBP]
   579 00000521 2B 46 0C                        	SUB	EAX,DWORD [12+ESI]
   580 00000524 50                              	PUSH	EAX
   581 00000525 FF 76 04                        	PUSH	DWORD [4+ESI]
   582 00000528 E8 [00000000]                   	CALL	_min
   583 0000052D 89 45 E4                        	MOV	DWORD [-28+EBP],EAX
   584 00000530 8B 45 18                        	MOV	EAX,DWORD [24+EBP]
   585 00000533 2B 46 10                        	SUB	EAX,DWORD [16+ESI]
   586 00000536 50                              	PUSH	EAX
   587 00000537 FF 76 08                        	PUSH	DWORD [8+ESI]
   588 0000053A E8 [00000000]                   	CALL	_min
   589 0000053F 83 C4 20                        	ADD	ESP,32
   590 00000542 89 D9                           	MOV	ECX,EBX
   591 00000544 39 C3                           	CMP	EBX,EAX
   592 00000546 89 45 E0                        	MOV	DWORD [-32+EBP],EAX
   593 00000549 7D 4E                           	JGE	L111
   594 0000054B                                 L106:
   595 0000054B 8B 7E 10                        	MOV	EDI,DWORD [16+ESI]
   596 0000054E 8B 55 E8                        	MOV	EDX,DWORD [-24+EBP]
   597 00000551 01 CF                           	ADD	EDI,ECX
   598 00000553 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   599 00000556 89 7D EC                        	MOV	DWORD [-20+EBP],EDI
   600 00000559 7D 38                           	JGE	L113
   601 0000055B                                 L105:
   602 0000055B 8B 46 0C                        	MOV	EAX,DWORD [12+ESI]
   603 0000055E 8B 5D DC                        	MOV	EBX,DWORD [-36+EBP]
   604 00000561 01 D0                           	ADD	EAX,EDX
   605 00000563 89 45 D0                        	MOV	DWORD [-48+EBP],EAX
   606 00000566 89 C8                           	MOV	EAX,ECX
   607 00000568 0F AF 46 04                     	IMUL	EAX,DWORD [4+ESI]
   608 0000056C 01 D0                           	ADD	EAX,EDX
   609 0000056E 0F B6 04 18                     	MOVZX	EAX,BYTE [EAX+EBX*1]
   610 00000572 3B 46 14                        	CMP	EAX,DWORD [20+ESI]
   611 00000575 74 16                           	JE	L102
   612 00000577 8B 7D 08                        	MOV	EDI,DWORD [8+EBP]
   613 0000057A 8B 45 EC                        	MOV	EAX,DWORD [-20+EBP]
   614 0000057D 8A 5D DB                        	MOV	BL,BYTE [-37+EBP]
   615 00000580 0F AF 47 08                     	IMUL	EAX,DWORD [8+EDI]
   616 00000584 03 45 D0                        	ADD	EAX,DWORD [-48+EBP]
   617 00000587 8B 7D D4                        	MOV	EDI,DWORD [-44+EBP]
   618 0000058A 88 1C 38                        	MOV	BYTE [EAX+EDI*1],BL
   619 0000058D                                 L102:
   620 0000058D 42                              	INC	EDX
   621 0000058E 3B 55 E4                        	CMP	EDX,DWORD [-28+EBP]
   622 00000591 7C C8                           	JL	L105
   623 00000593                                 L113:
   624 00000593 41                              	INC	ECX
   625 00000594 3B 4D E0                        	CMP	ECX,DWORD [-32+EBP]
   626 00000597 7C B2                           	JL	L106
   627 00000599                                 L111:
   628 00000599 8B 55 08                        	MOV	EDX,DWORD [8+EBP]
   629 0000059C FF 45 C8                        	INC	DWORD [-56+EBP]
   630 0000059F 8B 45 C8                        	MOV	EAX,DWORD [-56+EBP]
   631 000005A2 3B 42 10                        	CMP	EAX,DWORD [16+EDX]
   632 000005A5 0F 8E FFFFFF2E                  	JLE	L107
   633 000005AB E9 FFFFFF21                     	JMP	L109
